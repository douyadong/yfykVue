/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 项目名称：有房有客M站
 2. 页面名称：rent -> detail (租房详情页)
 3. 作者：zhaohuagang@lifang.com
 4. 备注：对api的依赖：jQuery
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
function DetailController() {
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    继承于Controller基类
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    Controller.call(this) ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    相册swiper处理
   -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.swipeAlbum() ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    下载app顶部条处理
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.wakeUpApp() ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    处理页面微信分享功能
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.wechatShare() ;
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    发送埋点数据
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.sendBigData() ;
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
下载app顶部条处理
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
DetailController.prototype.wakeUpApp = function() {
    $("#app-download .download").click(function(){
        new AppDownload({
            "androidSchemes" : "wkzf://external_call" ,
            "isoSchemes" : "wkzf://external_call" ,
            "androidDownloadLink" : "//m.wkzf.com/download/transit" ,
            "iosDownloadLink" : "//m.wkzf.com/download/transit"
        }) ;
    }) ;    
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 处理页面微信分享功能
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
DetailController.prototype.wechatShare = function() {
    new WechatShare({
        "title" : $("#wechatShareTitle").val() ,
        "timelineTitle" : $("#wechatShareTimelineTitle").val() ,
        "content" : $("#wechatShareContent").val() ,
        "imgUrl" : $("#wechatShareImgUrl").val() ,
        "environment" : this.environment
    }) ;
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 发送埋点数据
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
DetailController.prototype.sendBigData = function() {
    var classSelf = this ;
    $(".WKBigDataBtn").click(function() {            
        var data = $.parseJSON($(this).attr("data-WKparams")) ;        
        var sHref = $(this).attr('data-href') ; 
        $.ajax( classSelf.apiPrefix + classSelf.apiUrl.bigData , {
            "data" : data ,
            "success" : function() {
                alert("success" + sHref) ;
                sHref && ( window.location.href = sHref ) ;
            } ,
            "error" : function() {
                alert("error" + sHref) ;
                sHref && ( window.location.href = sHref ) ;
            }
        }) ;             
    }) ;  
} ;
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 类的初始化
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
$(document).ready(function() {
    new DetailController() ;
}) ;